rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Reglas para la colección 'products'
    match /products/{productId} {
      
      // LECTURA (read): Cualquiera puede leer los productos.
      // Esto es necesario para que el catálogo sea visible para todos los visitantes.
      allow read: if true;
      
      // ESCRITURA (create, update, delete): Solo los administradores pueden escribir.
      // Se verifica que el usuario esté autenticado (request.auth != null)
      // y que su token de autenticación contenga el custom claim { admin: true }.
      allow write: if request.auth != null && request.auth.token.admin == true;
    }
  }
}
